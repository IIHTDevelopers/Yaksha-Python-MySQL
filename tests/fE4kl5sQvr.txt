select e.emp_no, concat(e.first_name, ' ', e.last_name), title, d.dept_name from employees e inner join titles t on t.emp_no = e.emp_no inner join dept_emp de on de.emp_no = e.emp_no inner join departments d on d.dept_no = de.dept_no order by e.emp_no;
select e.emp_no, concat(first_name, ' ', last_name), s.salary from employees e inner join (select emp_no, max(salary) as salary from salaries group by emp_no) s on s.emp_no = e.emp_no order by e.emp_no; 
select e.emp_no, concat(e.first_name, ' ', e.last_name), title, d.dept_name, t.from_date, t.to_date from employees e inner join (select t1.* from titles t1  left join titles t2 on (t1.emp_no =  t2.emp_no and year(t1.from_date) < year(t2.from_date)) where year(t2.from_date) is NULL) t on t.emp_no = e.emp_no inner join dept_emp de on de.emp_no = e.emp_no inner join departments d on d.dept_no = de.dept_no order by e.emp_no;
select e.emp_no, concat(e.first_name, ' ', e.last_name) as emp_name,  de.dept_no, concat(em.first_name, ' ', em.last_name) as manager_name  from employees e inner join dept_emp de on de.emp_no = e.emp_no inner join dept_manager dm on dm.dept_no = de.dept_no inner join employees em on dm.emp_no = em.emp_no inner join titles t on t.emp_no = e.emp_no where (t.to_date)<= (dm.to_date) order by e.emp_no;
select e.emp_no, concat(e.first_name, ' ', e.last_name), title, de.dept_no, d.dept_name, concat(em.first_name, ' ', em.last_name) as manager_name, t.from_date, t.to_date from employees e inner join (select t1.* from titles t1  left join titles t2 on (t1.emp_no =  t2.emp_no and year(t1.from_date) < year(t2.from_date)) where year(t2.from_date) is NULL) t on t.emp_no = e.emp_no inner join dept_emp de on de.emp_no = e.emp_no inner join departments d on d.dept_no = de.dept_no inner join dept_manager dm on dm.dept_no = de.dept_no inner join employees em on dm.emp_no = em.emp_no where (t.to_date)<= (dm.to_date) order by e.emp_no;
select o.emp_no, group_concat(o.title separator ',') as titles from titles o inner join  (select emp_no, count(distinct(title)) as titles from titles group by emp_no having titles>1 ) i on o.emp_no=i.emp_no group by o.emp_no order by o.emp_no;
select e.emp_no, concat(e.first_name, ' ', e.last_name) as name, tt.salary, tt.from_date, tt.to_date from (select o.emp_no, i.salary, o .from_date, o.to_date from salaries o inner join  (select emp_no, max(salary) as salary from salaries where year(from_date) = 2000 group by emp_no) as i on o.emp_no=i.emp_no where o.salary=i.salary) as tt inner join employees e on e.emp_no = tt.emp_no order by e.emp_no;
select e.emp_no, concat(e.first_name, ' ', e.last_name) as name, tt.salary, concat(tt.f_y, '-', tt.t_y) as period from (select o.emp_no , i.salary, year(o.from_date) as f_y, year(o.to_date) as t_y from salaries o inner join  (select emp_no, min(salary) as salary from salaries group by emp_no) as i on o.emp_no=i.emp_no where o.salary=i.salary) as tt inner join employees e on e.emp_no = tt.emp_no order by e.emp_no;
